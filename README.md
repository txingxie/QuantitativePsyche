# Psychiatric Note Analysis Pipeline Using LLaMA and Cerebras

## Project Overview

This project evaluates psychiatric admission notes to determine severity scores and justifications for mental health dimensions, including:

- **Mood**
- **Anxiety**
- **Depression**
- **Suicidality**

The pipeline leverages **Cerebras Cloud Inference API** with the **LLaMA 3.1-8B** model to process unstructured psychiatric text into structured insights.

---

## Context

Mental health assessments often involve analyzing unstructured clinical notes. Automating this process:

1. Enhances consistency in mental health evaluations.
2. Reduces clinician workload.
3. Provides structured insights for further analysis and research.

This pipeline parses psychiatric notes, runs inference using LLaMA, and outputs structured results with severity scores and justifications.

---

## File Descriptions

### `preprocessing.py`

- **Purpose**: Reads raw psychiatric admission notes and formats them into prompts compatible with the LLaMA model.
- **Input**: A single `.txt` file containing a psychiatric admission note.
- **Output**: `formatted_prompts.csv` — A CSV file with:
  - Original `report`
  - Formatted `prompt` for LLaMA.

---

### `inference_pipeline.py`

- **Purpose**: Sends the formatted prompts to the Cerebras Cloud API and retrieves responses using the LLaMA model.
- **Input**: `formatted_prompts.csv` generated by `preprocessing.py`.
- **Output**: `results.csv` — Contains:
  - Original `report`
  - Raw responses from the LLaMA model.

---

### `postprocessing.py`

- **Purpose**: Parses and extracts severity scores and justifications for mood, anxiety, depression, and suicidality from the raw LLaMA response.
- **Input**: `results.csv` generated by `inference_pipeline.py`.
- **Output**: `parsed_results.csv` — Contains:
  - Original `report`
  - Scores and justifications for each dimension:
    - `mood_score`, `mood_justification`
    - `anxiety_score`, `anxiety_justification`
    - `depression_score`, `depression_justification`
    - `suicidality_score`, `suicidality_justification`

---

### `main.py`

- **Purpose**: Orchestrates the entire pipeline by executing:
  1. **Preprocessing**: Formats input `.txt` files into prompts.
  2. **Inference**: Sends prompts to the LLaMA model using Cerebras API.
  3. **Postprocessing**: Parses and outputs structured results.
- **Usage**:
  - Input: A psychiatric admission note (e.g., `admission_notes/note1.txt`).
  - Output: Results stored in separate files:
    - `formatted_prompts.csv`
    - `results.csv`
    - `parsed_results.csv`

---

## How to Run the Pipeline

### 1. **Setup Environment**

- Install dependencies:
  ```bash
  pip install pandas cerebras-cloud-sdk python-dotenv
  ```
